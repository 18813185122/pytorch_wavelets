==5558== NVPROF is profiling process 5558, command: python profile.py --no_grad --ref -j 3 -s 512 --batch 32
Traceback (most recent call last):
  File "profile.py", line 98, in <module>
    reference_fftconv(size, args.j, args.no_grad, args.device)
  File "profile.py", line 83, in reference_fftconv
    Y = torch.irfft(FY, 2, signal_sizes=xp.shape[-2:])
RuntimeError: CUDA error: out of memory
==5558== Profiling application: python profile.py --no_grad --ref -j 3 -s 512 --batch 32
==5558== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   49.53%  61.294ms         4  15.323ms  15.320ms  15.330ms  void kernelPointwiseApply3<TensorMulOp<float>, float, float, float, unsigned int, int=1, int=-1, int=2>(OffsetInfo<TensorMulOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=-1>, float, float)
                   24.14%  29.876ms         2  14.938ms  14.934ms  14.943ms  void kernelPointwiseApply2<CopyOp<float, float>, float, float, unsigned int, int=1, int=1>(OffsetInfo<float, float, float>, OffsetInfo<CopyOp<float, float>, float, unsigned int>, float, float)
                    6.84%  8.4692ms         1  8.4692ms  8.4692ms  8.4692ms  void kernelPointwiseApply3<TensorAddOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorAddOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    6.84%  8.4682ms         1  8.4682ms  8.4682ms  8.4682ms  void kernelPointwiseApply3<TensorSubOp<float>, float, float, float, unsigned int, int=1, int=1, int=1>(OffsetInfo<TensorSubOp<float>, float, unsigned int>, OffsetInfo<float, float, int=1>, OffsetInfo<float, float, int=1>, float, float)
                    4.24%  5.2493ms         8  656.16us  3.4240us  1.3088ms  void composite_3way_fft<unsigned int=1080, unsigned int=1, unsigned int=9, unsigned int=1, unsigned int=1, unsigned int=0, unsigned int=2, unsigned int=10, unsigned int=12, unsigned int=0, unsigned int, float>(kernel_arguments_t<unsigned int>)
                    3.50%  4.3300ms        17  254.71us     864ns  4.2383ms  [CUDA memcpy HtoD]
                    2.01%  2.4844ms         2  1.2422ms  1.2416ms  1.2428ms  __nv_static_69__56_tmpxft_0000407f_00000000_10_bluestein_compute_70_cpp1_ii_d293d249__Z14bluestein_convIf7ComplexIfEiEvT1_S2_S2_iT_PvS4_S4_
                    0.90%  1.1183ms         1  1.1183ms  1.1183ms  1.1183ms  __nv_static_69__56_tmpxft_0000407f_00000000_10_bluestein_compute_70_cpp1_ii_d293d249__Z17bluestein_morph2dI7ComplexIfEiEviT0_S2_S2_S2_S2_S2_S2_PKvS4_S4_Pv
                    0.69%  857.80us         1  857.80us  857.80us  857.80us  __nv_static_69__56_tmpxft_0000407f_00000000_10_bluestein_compute_70_cpp1_ii_d293d249__Z27bluestein_morph2d_input_r2cIf7ComplexIfEiEvT1_S2_S2_S2_S2_S2_S2_S2_S2_PKvS4_Pv10callback_t
                    0.65%  803.56us         1  803.56us  803.56us  803.56us  generate_normal(curandStateMtgp32*, int, float*, double, double)
                    0.28%  345.38us         1  345.38us  345.38us  345.38us  __nv_static_69__56_tmpxft_0000407f_00000000_10_bluestein_compute_70_cpp1_ii_d293d249__Z18bluestein_mult_c2cIfiEvT0_S0_S0_S0_S0_S0_iPKvS2_Pv10callback_t
                    0.26%  323.11us         1  323.11us  323.11us  323.11us  void kernelPointwiseApply2<CopyOp<float, float>, float, float, unsigned int, int=-1, int=1>(OffsetInfo<float, float, float>, OffsetInfo<CopyOp<float, float>, float, unsigned int>, float, float)
                    0.11%  141.41us         1  141.41us  141.41us  141.41us  void kernelPointwiseApply1<TensorFillOp<float>, float, unsigned int, int=1>(OffsetInfo<TensorFillOp<float>, float, unsigned int>, float, float)
      API calls:   97.39%  5.38943s        27  199.61ms  11.525us  5.34027s  cudaMalloc
                    1.72%  95.407ms         5  19.081ms  6.8720us  95.286ms  cudaStreamSynchronize
                    0.40%  21.875ms         6  3.6458ms  2.4224ms  7.5160ms  cudaGetDeviceProperties
                    0.16%  8.7853ms         8  1.0982ms  1.8640us  7.5585ms  cudaFree
                    0.13%  7.2373ms         8  904.66us  8.4890us  7.0703ms  cudaMemcpy
                    0.09%  4.8761ms       185  26.357us     168ns  1.1058ms  cuDeviceGetAttribute
                    0.08%  4.4435ms         9  493.72us  5.6080us  4.3275ms  cudaMemcpyAsync
                    0.01%  489.39us         2  244.70us  237.96us  251.43us  cuDeviceGetName
                    0.01%  402.17us        16  25.135us  6.9710us  53.352us  cudaLaunch
                    0.01%  352.39us         2  176.20us  175.92us  176.47us  cuDeviceTotalMem
                    0.00%  161.64us         8  20.204us  6.6270us  51.267us  cudaLaunchKernel
                    0.00%  133.30us       236     564ns     319ns  8.0340us  cudaGetDevice
                    0.00%  67.918us       104     653ns     360ns  6.2070us  cudaSetDevice
                    0.00%  21.490us       102     210ns     145ns  1.0900us  cudaSetupArgument
                    0.00%  9.6270us         2  4.8130us  4.8060us  4.8210us  cudaDeviceSynchronize
                    0.00%  9.4220us        27     348ns     167ns     937ns  cudaGetLastError
                    0.00%  7.8930us        16     493ns     186ns  1.5140us  cudaConfigureCall
                    0.00%  5.4290us        13     417ns     137ns  1.8660us  cudaGetDeviceCount
                    0.00%  2.7720us         4     693ns     168ns  2.0980us  cuDeviceGetCount
                    0.00%  2.5170us         9     279ns     160ns     490ns  cudaGetErrorString
                    0.00%  1.7710us         1  1.7710us  1.7710us  1.7710us  cuInit
                    0.00%  1.2960us         3     432ns     193ns     628ns  cuDeviceGet
                    0.00%     967ns         1     967ns     967ns     967ns  cuDriverGetVersion
======== Error: Application returned non-zero code 1
