python profile.py --no_grad -j 3 -s 512 --batch 32 -f -c
Type Time (%) Time (ms) Calls       Avg       Min       Max                                               Name
GPU activities:    75.24    15.143     1  15.143ms  15.143ms  15.143ms                maxwell_scudnn_128x32_relu_large_nn
GPU activities:    24.69     4.969     3  1.6563ms  1.1840us  4.9664ms                                 [CUDA memcpy HtoD]
GPU activities:     0.05  0.010304     1  10.304us  10.304us  10.304us  cudnn::maxwell::gemm::computeOffsetsKernel(cud...
GPU activities:     0.02  0.004192     4  1.0480us     992ns  1.2160us                                      [CUDA memset]
         Total:      100   20.1265     9                                                                                 
Total (no mem):    75.31   15.1575     6                                                                                 
     API calls:    99.76   5310.76    11  482.80ms  7.0460us  5.30862s                                         cudaMalloc
     API calls:      0.1    5.0709     2  2.5354ms  14.645us  5.0562ms                                    cudaMemcpyAsync
     API calls:     0.05     2.547   185  13.767us     251ns  571.00us                               cuDeviceGetAttribute
     API calls:     0.05    2.5206     2  1.2603ms  1.2574ms  1.2631ms                            cudaGetDeviceProperties
     API calls:     0.02    1.2671     1  1.2671ms  1.2671ms  1.2671ms                                      cudaHostAlloc
     API calls:     0.01     0.494     2  247.00us  246.79us  247.21us                                   cuDeviceTotalMem
     API calls:        0   0.25764     2  128.82us  128.04us  129.60us                                    cuDeviceGetName
     API calls:        0   0.21224     8  26.530us  14.224us  89.399us                          cudaStreamCreateWithFlags
     API calls:        0  0.097782     2  48.891us  5.9770us  91.805us                              cudaStreamSynchronize
     API calls:        0  0.077165     2  38.582us  14.655us  62.510us                                         cudaLaunch
     API calls:        0  0.059335     4  14.833us  13.434us  18.438us                       cudaStreamCreateWithPriority
     API calls:        0  0.038765    31  1.2500us     264ns  15.015us                                      cudaGetDevice
     API calls:        0  0.023159     4  5.7890us  2.9770us  10.708us                                    cudaMemsetAsync
     API calls:        0  0.020089     7  2.8690us     285ns  11.544us                                      cudaSetDevice
     API calls:        0  0.017264    28     616ns     447ns  1.8140us                           cudaEventCreateWithFlags
     API calls:        0  0.017117     1  17.117us  17.117us  17.117us                                         cudaMemcpy
     API calls:        0  0.010161    27     376ns     260ns  1.5210us                             cudaDeviceGetAttribute
     API calls:        0  0.007474    14     533ns     172ns  2.2860us                                 cudaGetDeviceCount
     API calls:        0  0.004788     2  2.3940us     496ns  4.2920us                                  cudaSetupArgument
     API calls:        0     0.004     4  1.0000us     283ns  2.8610us                                   cuDeviceGetCount
     API calls:        0  0.002573     1  2.5730us  2.5730us  2.5730us                                    cudaEventRecord
     API calls:        0  0.002083     1  2.0830us  2.0830us  2.0830us                           cudaHostGetDevicePointer
     API calls:        0   0.00185     2     925ns     758ns  1.0920us                                           cudaFree
     API calls:        0  0.001501     3     500ns     315ns     840ns                                        cuDeviceGet
     API calls:        0   0.00132     1  1.3200us  1.3200us  1.3200us                                             cuInit
     API calls:        0  0.001123     2     561ns     264ns     859ns                                  cudaConfigureCall
     API calls:        0  0.000972     4     243ns     107ns     439ns                                   cudaGetLastError
     API calls:        0  0.000943     1     943ns     943ns     943ns                   cudaDeviceGetStreamPriorityRange
     API calls:        0  0.000857     1     857ns     857ns     857ns                                 cuDriverGetVersion
         Total:    99.99   5323.52   355