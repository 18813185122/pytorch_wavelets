python profile.py --no_grad -j 3 -s 512 --batch 32 -f
Type Time (%) Time (ms)  Calls       Avg       Min       Max                                               Name
GPU activities:    38.99    20.509      6  3.4182ms  3.4111ms  3.4252ms             maxwell_scudnn_128x32_relu_interior_nn
GPU activities:    13.24    6.9675     30  232.25us  40.448us  593.67us  void kernelPointwiseApply2<TensorTakeOp<float,...
GPU activities:     10.4    5.4723     12  456.02us  126.95us  1.2009ms  void spatialDepthwiseConvolutionUpdateOutput<f...
GPU activities:     9.54    5.0214     62  80.990us     864ns  4.9531ms                                 [CUDA memcpy HtoD]
GPU activities:     6.36     3.344     50  66.880us  1.6000us  288.52us  void kernelPointwiseApply3<TensorAddOp<long>, ...
GPU activities:     5.11    2.6902     36  74.728us  4.2880us  182.82us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     3.03    1.5952     24  66.464us  2.7520us  311.11us  void CatArrayBatchedCopy<float, unsigned int, ...
GPU activities:     2.72    1.4332     18  79.622us  12.416us  181.70us  void kernelPointwiseApply3<TensorAddOp<float>,...
GPU activities:     2.67     1.405     18  78.057us  11.456us  177.22us  void kernelPointwiseApply3<TensorSubOp<float>,...
GPU activities:     2.12    1.1157      9  123.97us  17.824us  282.69us  void kernelPointwiseApply2<TensorDivConstantOp...
GPU activities:     2.12    1.1133     18  61.847us  9.2480us  144.00us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     1.67    0.8802      8  110.03us  38.080us  183.39us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     0.67   0.35274     16  22.046us  7.9360us  36.096us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     0.24   0.12803    120  1.0660us     992ns  1.3760us                                 [CUDA memcpy DtoH]
GPU activities:     0.23   0.12304     30  4.1010us  3.9360us  5.0240us  void kernelReduceAll<long, unsigned int, long,...
GPU activities:     0.23   0.11869     30  3.9560us  3.8720us  4.0960us  void kernelReduceAll<long, unsigned int, long,...
GPU activities:     0.14  0.075328     60  1.2550us     928ns  1.5680us  void kernelPointwiseApply2<TensorMulConstantOp...
GPU activities:     0.11  0.059073     50  1.1810us     832ns  2.5920us  void thrust::cuda_cub::core::_kernel_agent<thr...
GPU activities:      0.1   0.05488      6  9.1460us  9.0560us  9.2800us  cudnn::maxwell::gemm::computeOffsetsKernel(cud...
GPU activities:      0.1  0.054496     60     908ns     768ns  1.1200us  void kernelPointwiseApply1<TensorFillOp<long>,...
GPU activities:      0.1    0.0504     30  1.6800us  1.5040us  2.4640us  void kernelPointwiseApply2<TensorRemainderOp<l...
GPU activities:     0.08  0.039585     30  1.3190us     992ns  1.6320us                                 [CUDA memcpy DtoD]
GPU activities:     0.01  0.004352      4  1.0880us     992ns  1.3440us                                      [CUDA memset]
         Total:    99.98   52.6076    727                                                                                 
Total (no mem):    90.12   47.4186    515                                                                                 
     API calls:    98.77   5100.91     25  204.04ms  7.1090us  5.09551s                                         cudaMalloc
     API calls:      0.7    36.104    160  225.65us  1.6740us  7.9679ms                              cudaStreamSynchronize
     API calls:     0.16     8.028    214  37.513us     561ns  5.0522ms                                    cudaMemcpyAsync
     API calls:     0.11    5.6493    511  11.055us  6.9020us  117.74us                                         cudaLaunch
     API calls:     0.06    3.0371    185  16.416us     308ns  696.72us                               cuDeviceGetAttribute
     API calls:     0.06     3.008      2  1.5040ms  1.4510ms  1.5570ms                            cudaGetDeviceProperties
     API calls:     0.05    2.4399      3  813.29us  15.228us  1.2473ms                                      cudaHostAlloc
     API calls:     0.04    1.9799   6432     307ns     254ns  11.771us                                      cudaGetDevice
     API calls:     0.02    0.8071   2162     373ns     275ns  7.6510us                                      cudaSetDevice
     API calls:     0.01    0.6289      2  314.45us  303.31us  325.59us                                   cuDeviceTotalMem
     API calls:     0.01   0.33177   2270     146ns     106ns     989ns                                  cudaSetupArgument
     API calls:     0.01   0.31422      2  157.11us  153.44us  160.78us                                    cuDeviceGetName
     API calls:        0   0.23393      8  29.241us  14.293us  116.75us                          cudaStreamCreateWithFlags
     API calls:        0   0.17193     50  3.4380us  2.8790us  16.791us                              cudaFuncGetAttributes
     API calls:        0   0.12317    631     195ns     104ns     648ns                                   cudaGetLastError
     API calls:        0   0.10598    511     207ns     137ns  1.4400us                                  cudaConfigureCall
     API calls:        0  0.063853      4  15.963us  13.796us  20.184us                       cudaStreamCreateWithPriority
     API calls:        0  0.063394     33  1.9210us     800ns  3.5730us                                     cudaEventQuery
     API calls:        0  0.052228     52  1.0040us     439ns  2.5560us                           cudaEventCreateWithFlags
     API calls:        0  0.044551     30  1.4850us  1.0170us  2.7950us                                    cudaEventRecord
     API calls:        0  0.035771     77     464ns     255ns     846ns                             cudaDeviceGetAttribute
     API calls:        0  0.032105      4  8.0260us  3.1480us  19.044us                                    cudaMemsetAsync
     API calls:        0  0.027024     23  1.1740us     478ns  2.1390us                                   cudaEventDestroy
     API calls:        0  0.020927      1  20.927us  20.927us  20.927us                                         cudaMemcpy
     API calls:        0  0.019074      4  4.7680us     418ns  17.585us                                   cuDeviceGetCount
     API calls:        0  0.017063    100     170ns     107ns     518ns                                cudaPeekAtLastError
     API calls:        0   0.00824     14     588ns     164ns  2.1320us                                 cudaGetDeviceCount
     API calls:        0  0.002632      1  2.6320us  2.6320us  2.6320us                           cudaHostGetDevicePointer
     API calls:        0  0.002165      3     721ns     371ns  1.2460us                                        cuDeviceGet
     API calls:        0  0.001827      2     913ns     758ns  1.0690us                                           cudaFree
     API calls:        0  0.001456      1  1.4560us  1.4560us  1.4560us                                             cuInit
     API calls:        0  0.001397      1  1.3970us  1.3970us  1.3970us                                 cuDriverGetVersion
     API calls:        0  0.001136      1  1.1360us  1.1360us  1.1360us                   cudaDeviceGetStreamPriorityRange
         Total:      100   5164.27  13519